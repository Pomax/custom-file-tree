file-tree {
  display: block;

  button {
    min-width: 1.5em;
    padding: 2px 1px;
    display: none;
  }

  .selected > button,
  dir-entry[path="."] > button {
    display: inline-block;
  }

  .icon {
    position: relative;
    display: inline-block;
    width: 1.25em;
    height: 1.25em;
    &:before {
      position: absolute;
      bottom: -0.25em;
      left: 0;
      content: "?";
    }
  }

  /* by default the top level is hidden*/
  &:not([show-top-level]) > dir-entry[path="."] {
    margin: 0 !important;
    padding: 0 !important;
    &:before {
      content: unset;
    }
    & > *:not(dir-entry, file-entry) {
      display: none !important;
    }
    /* but we do need some of the buttons */
    & > button {
      &.create-file {
        margin-left: 0 !important;
      }
      &.create-file,
      &.create-dir,
      &.upload {
        display: inline-block !important;
        margin-bottom: 0.5em;
      }
    }
  }

  dir-entry {
    display: block;

    entry-heading {
      margin-left: 0.25em;
      cursor: pointer;
    }

    &.dragging {
      opacity: 0.2;
    }

    &.drop-target {
      background: #e3fff4;
    }

    &[path] {
      margin-bottom: 0.25em;

      & > file-entry,
      & > dir-entry {
        --padding: 1em;
        padding-left: var(--padding);
      }

      /*
        the root dir is a bit special: it shoudl have buttons for
        creating or uploading files, but should not offer buttons
        to rename or delete it:
      */
      &[path="."] {
        height: 100%;
        cursor: auto;

        & > entry-heading {
          cursor: auto;
        }

        &:before {
          cursor: auto;
        }

        & > button {
          display: none;
          &.create-file,
          &.create-dir,
          &.upload {
            display: inline-block;
          }
        }
      }

      & > .icon:before {
        content: "ðŸ“’";
        cursor: pointer;
      }

      &.closed {
        & > .icon:before {
          content: "ðŸ“•";
        }
        dir-entry,
        file-entry {
          display: none;
        }
      }
    }
  }

  file-entry {
    display: block;
    white-space: nowrap;

    entry-heading {
      cursor: pointer;
    }

    & > .icon:before {
      position: relative;
      content: "ðŸ“„";
      cursor: pointer;
      margin-right: 0.25em;
    }

    &.dragging {
      opacity: 0.2;
    }
  }

  dir-entry.selected > entry-heading,
  file-entry.selected {
    background: #e3f6ff;
    border: 1px solid blue;
    box-sizing: border-box;
    margin: -1px;
    margin-left: calc(-1px - 0.25em);
  }
  file-entry.selected {
    padding-left: 0.25em;
  }
  dir-entry.selected > entry-heading {
    margin-right: -0.5em;
    padding: 2px 0.5em;
  }
}
