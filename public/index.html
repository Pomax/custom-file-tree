<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>File-tree demo</title>
    <script
      src="https://pomax.github.io/dragdroptouch/dist/drag-drop-touch.esm.min.js?autoload"
      type="module"
    ></script>
    <link rel="stylesheet" href="../dist/file-tree.css" async />
    <script src="index.js" type="module" async></script>
    <link rel="stylesheet" href="index.css" async />
  </head>

  <body>
    <header>
      <h1>
        This is a
        <a href="https://github.com/pomax/custom-file-tree"
          ><code>&lt;file-tree&gt;</code></a
        >
      </h1>
      <p>
        It shows off a dummy file tree with blanket "do everything" permissions
        (there are no real files backing this tree, it's <em>just</em> the file
        tree interface, generating permission events that we just blanket allow
        in order to show off the interface).
      </p>
    </header>

    <h2>The element:</h2>

    <file-tree></file-tree>

    <p>
      You can click files, drag files and directories around, create, rename,
      and delete files and directories, and you can upload files or entire
      folders from your device (which, because this file tree isn't backed by
      anything, just means you see your filenames show up in the tree, there is
      no data associated with them on this page).
    </p>

    <h2>The HTML that made the above work:</h2>

    <p>
      It's an HTML element. The code is literally just
      <code>&lt;file-tree&gt;&lt;/file-tree&gt;</code> and that's all you need.
      The rest is on the JS side, but that part's also <em>pretty</em> minimal.
    </p>

    <h2>The JS that made the above work:</h2>

    <p>
      The JS just gets our file tree element, and passes it a bunch of file
      names as an array. Then in order to make sure the tree "works", every
      permission event is immediately granted:
    </p>

    <pre><code>// Add &lt;file-tree&gt; to our page and grab the element
import "../dist/file-tree.esm.min.js";
const fileTree = document.querySelector(`file-tree`);

// Set some files. Intentionally terribly sorted.
const demoList = [
  `src/utils.js`,
  `README.md`,
  `dist/README.md`,
  `dist/file-tree.esm.js`,
  `test/README.md`,
  `public/index.html`,
  `src/file-entry.js`,
  `public/README.md`,
  `src/dir-entry.js`,
  `package.json`,
  `public/index.js`,
  `src/README.md`,
  `dist/file-tree.esm.min.js`,
  `test/cake.because.why.not`,
  `src/file-tree.js`,
  `src/file-tree.css`,
];

fileTree.setFiles(demoList);

// Listen for, and grant every, file tree event
const eventList = [
  // The main event your users care about
  `file:click`,
  // File events you care about
  `file:create`,
  `file:rename`,
  `file:upload`,
  `file:move`,
  `file:delete`,
  // Directory events you care about
  `dir:click`,
  `dir:create`,
  `dir:rename`,
  `dir:move`,
  `dir:delete`,
];

eventList.forEach((type) =>
  fileTree.addEventListener(type, (evt) => {
    const { type, detail } = evt;
    delete detail.content; // if we're uploading files, don't log their content: we don't care.
    console.log(type, detail);
    detail.grant();
  })
);</code></pre>

    <h2>See for yourself</h2>

    <p>
      View-source this page, and <a href="index.js">the page JS</a>. It's about
      as dumb as I could make it. Dumb is good. Dumb gets work done.
    </p>
  </body>
</html>
