<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>File-tree demo</title>
    <script
      src="https://pomax.github.io/dragdroptouch/dist/drag-drop-touch.esm.min.js?autoload"
      type="module"
    ></script>
    <link rel="stylesheet" href="../dist/file-tree.css" async />
    <script src="index.js" type="module" async></script>
    <link rel="stylesheet" href="index.css" async />
  </head>

  <body>
    <header>
      <h1>
        This is a
        <a href="https://github.com/pomax/custom-file-tree"
          ><code>&lt;file-tree&gt;</code></a
        >
      </h1>
      <p>
        It shows off a dummy file tree with blanket "do everything" permissions
        (there are no real files backing this tree, it's <em>just</em> the file
        tree interface, generating permission events that we just blanket allow
        in order to show off the interface).
      </p>
    </header>

    <h2>The element:</h2>

    <file-tree></file-tree>

    <p>
      You can click files, drag files and directories around, create, rename,
      and delete files and directories, and you can upload files or entire
      folders from your device (which, because this file tree isn't backed by
      anything, just means you see your filenames show up in the tree, there is
      no data associated with them on this page).
    </p>

    <h2>The HTML that made the above work:</h2>

    <p>
      It's an HTML element. The code is identical to other HTML elements, in
      that you just write <code>&lt;file-tree&gt;&lt;/file-tree&gt;</code> (or
      generate a `file-tree` element) and that's all you need as far as the page
      code is concerned.
    </p>

    <h2>The JS that made the above work:</h2>

    <p>
      On th JS side, we get a reference to our file tree element, and then pass
      it a list of file paths, as an array of strings. Then, in order to make
      sure that you can see the tree "working", we set up event listeners for
      all permission events the file tree generates, granting them immediately.
    </p>

    <pre><code>// Add &lt;file-tree&gt; to our page and grab the element
import "../dist/file-tree.esm.min.js";
const fileTree = document.querySelector(`file-tree`);

// Set some files. Intentionally terribly sorted.
const demoList = [
  `src/utils.js`,
  `README.md`,
  `dist/README.md`,
  `dist/file-tree.esm.js`,
  `test/README.md`,
  `public/index.html`,
  `src/file-entry.js`,
  `public/README.md`,
  `src/dir-entry.js`,
  `package.json`,
  `public/index.js`,
  `src/README.md`,
  `dist/file-tree.esm.min.js`,
  `test/cake.because.why.not`,
  `src/file-tree.js`,
  `src/file-tree.css`,
];

fileTree.setFiles(demoList);

// Listen for, and grant every, file tree event
const eventList = [
  // The main event your users care about
  `file:click`,
  // File events you care about
  `file:create`,
  `file:rename`,
  `file:upload`,
  `file:move`,
  `file:delete`,
  // Directory events you care about
  `dir:click`,
  `dir:create`,
  `dir:rename`,
  `dir:move`,
  `dir:delete`,
];

eventList.forEach((type) =>
  fileTree.addEventListener(type, (evt) => {
    const { type, detail } = evt;
    delete detail.content; // if we're uploading files, don't log their content: we don't care.
    console.log(type, detail);
    detail.grant();
  })
);</code></pre>

    <h2>See for yourself</h2>

    <p>
      If you `view-source` this page, you'll see there's nothing special going
      on in the HTML, and viewing the <a href="index.js">page JS</a> should show
      the same code as listed above.
    </p>

    <p>
      For more information, head on over to its
      <a href="https://github.com/Pomax/custom-file-tree">project page</a> on
      GitHub, which has more detailed instructions on how to use this element,
      and how to work with th events it generates.
    </p>

    <p>&mdash; <a href="https://mastodon.social/@TheRealPomax">Pomax</a></p>
  </body>
</html>
